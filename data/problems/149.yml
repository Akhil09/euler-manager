---
:id: 149
:name: Searching for a maximum-sum subsequence
:content:
- Looking at the table below, it is easy to verify that the maximum possible sum of
  adjacent numbers in any direction (horizontal, vertical, diagonal or anti-diagonal)
  <span style="white-space:nowrap">is 16 (= 8 + 7 + 1).</span>
- 'Now, let us repeat the search, but on a much larger scale:'
- 'First, generate four million pseudo-random numbers using a specific form of what
  is known as a "Lagged Fibonacci Generator":'
- "For 1 <img src=\"images/symbol_le.gif\" width=\"10\" height=\"12\" alt=\"≤\" border=\"0\"
  style=\"vertical-align:middle;\"><i>k</i> <img src=\"images/symbol_le.gif\" width=\"10\"
  height=\"12\" alt=\"≤\" border=\"0\" style=\"vertical-align:middle;\"> 55, <i>s</i><sub><i>k</i></sub>
  = [100003 <img src=\"images/symbol_minus.gif\" width=\"9\" height=\"3\" alt=\"−\"
  border=\"0\" style=\"vertical-align:middle;\"> 200003<i>k</i> + 300007<i>k</i><sup>3</sup>]
  (modulo 1000000) <img src=\"images/symbol_minus.gif\" width=\"9\" height=\"3\" alt=\"−\"
  border=\"0\" style=\"vertical-align:middle;\"> 500000.<br>\r\nFor 56 <img src=\"images/symbol_le.gif\"
  width=\"10\" height=\"12\" alt=\"≤\" border=\"0\" style=\"vertical-align:middle;\"><i>k</i>
  <img src=\"images/symbol_le.gif\" width=\"10\" height=\"12\" alt=\"≤\" border=\"0\"
  style=\"vertical-align:middle;\"> 4000000, <i>s</i><sub><i>k</i></sub> = [<i>s</i><sub><i>k<img
  src=\"images/symbol_minus.gif\" width=\"9\" height=\"3\" alt=\"−\" border=\"0\"
  style=\"vertical-align:middle;\">24</i></sub> + <i>s</i><sub><i>k<img src=\"images/symbol_minus.gif\"
  width=\"9\" height=\"3\" alt=\"−\" border=\"0\" style=\"vertical-align:middle;\">55</i></sub>
  + 1000000] (modulo 1000000) <img src=\"images/symbol_minus.gif\" width=\"9\" height=\"3\"
  alt=\"−\" border=\"0\" style=\"vertical-align:middle;\"> 500000."
- Thus, <i>s</i><sub>10</sub> = <img src="images/symbol_minus.gif" width="9" height="3"
  alt="−" border="0" style="vertical-align:middle;">393027 and <i>s</i><sub>100</sub>
  = 86613.
- The terms of <i>s</i> are then arranged in a 2000<img src="images/symbol_times.gif"
  width="9" height="9" alt="×" border="0" style="vertical-align:middle;">2000 table,
  using the first 2000 numbers to fill the first row (sequentially), the next 2000
  numbers to fill the second row, and so on.
- Finally, find the greatest sum of (any number of) adjacent entries in any direction
  (horizontal, vertical, diagonal or anti-diagonal).
